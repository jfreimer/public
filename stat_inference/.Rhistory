lambda <- 0.2
n <- 1000
sim <- replicate(n,(mean(rexp(40,rate=lambda))))
1)
sim.mean <- mean(sim)
thr.mean <- 1/lambda
diff.mean <- thr.mean - sim.mean
2)
sim.sd <- sd(sim)
thr.sd <- 1/lambda/sqrt(40)
diff.sd <- thr.sd - sim.sd
3)
hist(sim)
qqnorm(sim)
qqline(sim)
sim.mean + c(-1,1)*sim.sd/sqrt(40)
sim.mean + c(-1,1)*sim.sd/sqrt(1000)
sim
sim < 5.1
sim.mean + c(-1,1)*sim.sd/sqrt(40)
test <- sim.mean + c(-1,1)*sim.sd/sqrt(40)
sim > test[1] & sim < test[2]
test <- sim.mean + c(-1,1)*sim.sd/sqrt(40)
sim > test[1] & sim < test[2]
test <- sim.mean + c(-1,1)*sim.sd/sqrt(1000)
1/lambda
test <- sim.mean + c(-1,1)*1.96*sim.sd/sqrt(1000)
test <- sim.mean + c(-1,1)*1.96*sim.sd/sqrt(1000)
sim.mean + c(-1,1)*1.96*sim.sd/sqrt(1000)
1.96*sim.sd/sqrt(1000)
1.96*sim.sd/sqrt(40)
sim.mean + c(-1,1)*1.96*sim.sd/sqrt(1000)
thr.sd <- 1/lambda/sqrt(40)
thr.sd <- 1/lambda/sqrt(1000)
thr.sd <- 1/lambda/sqrt(40)
n <- 20
pvals <- seq(0.1, 0.9, by = 0.05)
nosim <- 1000
coverage <- sapply(pvals, function(p) {
phats <- rnorm(nosim, prob = p, size = n)/n
ll <- phats - qnorm(0.975) * sqrt(phats * (1 - phats)/n)
ul <- phats + qnorm(0.975) * sqrt(phats * (1 - phats)/n)
mean(ll < p & ul > p)
})
rnorm
?rnorm
n <- 40
pvals <- seq(0.1, 0.9, by = 0.05)
nosim <- 1000
coverage <- sapply(pvals, function(p) {
phats <- rnorm(nosim, mean=5,sd=thr.sd )/n
ll <- phats - qnorm(0.975) * sqrt(phats * (1 - phats)/n)
ul <- phats + qnorm(0.975) * sqrt(phats * (1 - phats)/n)
mean(ll < p & ul > p)
})
plot(coverage)
x <- (rexp(40,rate=lambda)
x <- (rexp(40,rate=lambda))
x <- (rexp(40,rate=lambda))
ll <- x - 1.96*thr.sd/sqrt(40)
ul <- x + 1.96*thr.sd/sqrt(40)
mean(ll < 1/lambda & up > 1/lambda)
mean(ll < 1/lambda & ul > 1/lambda)
x <- (rexp(40,rate=lambda))
ll <- x - 1.96*5/sqrt(40)
ul <- x + 1.96*5/sqrt(40)
mean(ll < 1/lambda & ul > 1/lambda)
x
x <- (rexp(40,rate=lambda))
ll <- x - 1.96*5/sqrt(40)
ul <- x + 1.96*5/sqrt(40)
mean(ll < 1/lambda & ul > 1/lambda)
x <- (rexp(40,rate=lambda))
ll <- x - 1.96*5/sqrt(40)
ul <- x + 1.96*5/sqrt(40)
mean(ll < 1/lambda & ul > 1/lambda)
?rexp
rexp(40,rate=lambda)
rexp(40,rate=lambda)
rexp(40,rate=lambda)
rexp(40,rate=lambda)
plot(rexp(40,rate=lambda))
plot(rexp(40,rate=lambda))
plot(rexp(40,rate=lambda))
plot(rexp(40,rate=lambda))
plot(rexp(1000,rate=lambda))
thr.sd <- (1/lambda)/sqrt(40)
conf.interval <- thr.mean + c(-1,1)*1.96*thr.sd
mean(conf.interval[1] < sim & sim < conf.interval[2] )
conf.interval[1] < sim & sim < conf.interval[2]
which(conf.interval[1] < sim & sim < conf.interval[2])
sum(conf.interval[1] < sim & sim < conf.interval[2])
thr.sd^2
var(sim)
?hist
data(ToothGrowth)
ToothGrowth
hist(ToothGrowth)
str(ToothGrowth)
tg <- ToothGrowth
tg$dose <- as.factor(tg$dose)
tg
tg$supp=VC
VC <- tg[supp="VC",]
VC <- tg[supp=VC,]
VC <- tg[tg$supp=VC,]
VC <- tg[tg$supp==VC,]
VC <- tg[tg$supp=='VC',]
VC
boxplot(VC$1)
boxplot(VC$len)
VC <- tg[tg$supp=='VC',]
OJ <- tg[tg$supp=='OJ',]
boxplot(VC,OJ)
boxplot(VC$len,OJ$len)
?boxplot
?plot
boxplot(VC$len,OJ$len,ylab='tooth length',names=c('Vitamin C','Orange Juice'),main='Tooth length of Vitamin C vs Orange Juice')
data(ToothGrowth)
?ToothGrowth
after Vitamin C vs Orange Juice treatment')
boxplot(VC$len,OJ$len,ylab='tooth length',names=c('Vitamin C','Orange Juice'),main='Tooth length
after Vitamin C vs Orange Juice treatment')
boxplot(VC$len,OJ$len,ylab='tooth length',names=c('Vitamin C','Orange Juice'),main='Tooth length after Vitamin C vs Orange Juice treatment')
Orange Juice treatment')
hist(VC)
hist(VC$len)
hist(OJ$len)
hist(tg$len)
dose.5 <- tg[tg$dose=='0.5',]
dose1 <- tg[tg$dose=='1',]
dose2 <- tg[tg$dose=='2',]
hist(dose1$len)
?ToothGrowth
Orange Juice treatment')
boxplot(dose.5$len,dose1$len,dose2$len,ylab='tooth length',xlab='Vitamin C doses',names=c('0.5mg','1mg','2mg'),main='Tooth length after Vitamin C vs
Orange Juice treatment')
View(tg)
boxplot(supp~dose,data=tg)
class(ToothGrowth)
class(ToothGrowth$dose)
class(tg$dose)
class(tg$supp)
boxplot(dose~supp,data=tg)
boxplot(len~sup,data=tg)
boxplot(len~supp,data=tg)
boxplot(len~dose,data=tg)
?boxplot
boxplot(len~interaction(supp,dose),data=tg)
boxplot(len~interaction(supp,dose),data=tg,ylab="Tooth Length",names=c("OJ 0.5mg","VC 0.5mg","OJ 1mg","VC 1mg","OJ 2mg","VC 2mg"),main="Tooth length by treatment and dose")
?plot
?boxplot
fill = c("yellow", "orange"))
boxplot(len~interaction(supp,dose),data=tg,ylab="Tooth Length",names=c("OJ 0.5mg","VC 0.5mg","OJ 1mg","VC 1mg","OJ 2mg","VC 2mg"),main="Tooth length by treatment and dose")
legend(2, 9, c("Ascorbic acid", "Orange juice"),
fill = c("yellow", "orange"))
boxplot(len~interaction(supp,dose),data=tg,ylab="Tooth Length",names=c("OJ 0.5mg","VC 0.5mg","OJ 1mg","VC 1mg","OJ 2mg","VC 2mg"),main="Tooth length by treatment and dose",col=c("orange", "yellow"))
fill = c("orange", "yellow"))
legend(0, 0, c("Orange juice (OJ)", "Vitamin C (VC)"),
fill = c("orange", "yellow"))
boxplot(len~interaction(supp,dose),data=tg,ylab="Tooth Length",names=c("OJ 0.5mg","VC 0.5mg","OJ 1mg","VC 1mg","OJ 2mg","VC 2mg"),main="Tooth length by treatment and dose",col=c("orange", "yellow"))
legend(0, 0, c("Orange juice (OJ)", "Vitamin C (VC)"),
fill = c("orange", "yellow"))
boxplot(len~interaction(supp,dose),data=tg,ylab="Tooth Length",names=c("OJ 0.5mg","VC 0.5mg","OJ 1mg","VC 1mg","OJ 2mg","VC 2mg"),main="Tooth length by treatment and dose",col=c("orange", "yellow"))
legend(1, 1, c("Orange juice (OJ)", "Vitamin C (VC)"),
fill = c("orange", "yellow"))
boxplot(len~interaction(supp,dose),data=tg,ylab="Tooth Length",names=c("OJ 0.5mg","VC 0.5mg","OJ 1mg","VC 1mg","OJ 2mg","VC 2mg"),main="Tooth length by treatment and dose",col=c("orange", "yellow"))
legend(10, 10, c("Orange juice (OJ)", "Vitamin C (VC)"),
fill = c("orange", "yellow"))
?legend
boxplot(len~interaction(supp,dose),data=tg,ylab="Tooth Length",names=c("OJ 0.5mg","VC 0.5mg","OJ 1mg","VC 1mg","OJ 2mg","VC 2mg"),main="Tooth length by treatment and dose",col=c("orange", "yellow"))
legend(2, 9, c("Orange juice (OJ)", "Vitamin C (VC)"),
fill = c("orange", "yellow"))
boxplot(len~interaction(supp,dose),data=tg,ylab="Tooth Length",names=c("OJ 0.5mg","VC 0.5mg","OJ 1mg","VC 1mg","OJ 2mg","VC 2mg"),main="Tooth length by treatment and dose",col=c("orange", "yellow"))
legend(4, 9, c("Orange juice (OJ)", "Vitamin C (VC)"),
fill = c("orange", "yellow"))
boxplot(len~interaction(supp,dose),data=tg,ylab="Tooth Length",names=c("OJ 0.5mg","VC 0.5mg","OJ 1mg","VC 1mg","OJ 2mg","VC 2mg"),main="Tooth length by treatment and dose",col=c("orange", "yellow"))
legend(3, 9, c("Orange juice (OJ)", "Vitamin C (VC)"),
fill = c("orange", "yellow"))
boxplot(len~interaction(supp,dose),data=tg,ylab="Tooth Length",names=c("OJ 0.5mg","VC 0.5mg","OJ 1mg","VC 1mg","OJ 2mg","VC 2mg"),main="Tooth length by treatment and dose",col=c("orange", "yellow"))
legend(1, 30, c("Orange juice (OJ)", "Vitamin C (VC)"),
fill = c("orange", "yellow"))
boxplot(len~interaction(supp,dose),data=tg,ylab="Tooth Length",names=c("OJ 0.5mg","VC 0.5mg","OJ 1mg","VC 1mg","OJ 2mg","VC 2mg"),main="Tooth length by treatment and dose",col=c("orange", "yellow"))
legend(0, 30, c("Orange juice (OJ)", "Vitamin C (VC)"),
fill = c("orange", "yellow"))
boxplot(len~interaction(supp,dose),data=tg,ylab="Tooth Length",names=c("OJ 0.5mg","VC 0.5mg","OJ 1mg","VC 1mg","OJ 2mg","VC 2mg"),main="Tooth length by treatment and dose",col=c("orange", "yellow"))
legend(0.5, 35, c("Orange juice (OJ)", "Vitamin C (VC)"),
fill = c("orange", "yellow"))
boxplot(len~interaction(supp,dose),data=tg,ylab="Tooth Length",names=c("OJ 0.5mg","VC 0.5mg","OJ 1mg","VC 1mg","OJ 2mg","VC 2mg"),main="Tooth length by treatment and dose",col=c("orange", "yellow"))
legend(0.5, 34, c("Orange juice (OJ)", "Vitamin C (VC)"),
fill = c("orange", "yellow"))
?ToothGrowth
View(ToothGrowth)
mean(len~interaction(supp,dose),data=tg)
packages.install("dplyr")
install.packages("dplyr")
library(dplyr)
?summarise
summarise(tg)
summarise(tg,mean=mean(len))
summarise(tg,~supp,mean=mean(len))
supp <- group_by(tg,supp)
summarise(supp)
summarise(supp, mean(len))
supp <- group_by(tg,supp,dose)
summarise(supp, mean(len))
tg.grouped <- group_by(tg,supp,dose)
summarise(tg.grouped, mean(len), sd(len))
?ToothGrowth
boxplot(len~interaction(supp,dose),data=tg,ylab="Tooth Length",
names=c("OJ 0.5mg","AA 0.5mg","OJ 1mg","AA 1mg","AA 2mg","AA 2mg"),
main="Tooth length by treatment and dose",col=c("orange", "yellow")
cex.main=.5,cex.lab=.5,cex.axis=.5)
boxplot(len~interaction(supp,dose),data=tg,ylab="Tooth Length",
names=c("OJ 0.5mg","AA 0.5mg","OJ 1mg","AA 1mg","AA 2mg","AA 2mg"),
main="Tooth length by treatment and dose",col=c("orange", "yellow")
cex.main=".5",cex.lab=.5,cex.axis=.5)
boxplot(len~interaction(supp,dose),data=tg,ylab="Tooth Length",
names=c("OJ 0.5mg","AA 0.5mg","OJ 1mg","AA 1mg","AA 2mg","AA 2mg"),
main="Tooth length by treatment and dose",col=c("orange", "yellow"))
cex=.5
boxplot(len~interaction(supp,dose),data=tg,ylab="Tooth Length",
names=c("OJ 0.5mg","AA 0.5mg","OJ 1mg","AA 1mg","AA 2mg","AA 2mg"),
main="Tooth length by treatment and dose",col=c("orange", "yellow"), cex=.5)
boxplot(len~interaction(supp,dose),data=tg,ylab="Tooth Length",
names=c("OJ 0.5mg","AA 0.5mg","OJ 1mg","AA 1mg","AA 2mg","AA 2mg"),
main="Tooth length by treatment and dose",col=c("orange", "yellow"), cex=.5)
boxplot(len~interaction(supp,dose),data=tg,ylab="Tooth Length",
names=c("OJ 0.5mg","AA 0.5mg","OJ 1mg","AA 1mg","AA 2mg","AA 2mg"),
main="Tooth length by treatment and dose",col=c("orange", "yellow"), cex=.1)
boxplot(len~interaction(supp,dose),data=tg,ylab="Tooth Length",
names=c("OJ 0.5mg","AA 0.5mg","OJ 1mg","AA 1mg","AA 2mg","AA 2mg"),
main="Tooth length by treatment and dose",col=c("orange", "yellow"), cex=.1)
boxplot(len~interaction(supp,dose),data=tg,ylab="Tooth Length",
names=c("OJ 0.5mg","AA 0.5mg","OJ 1mg","AA 1mg","AA 2mg","AA 2mg"),
main="Tooth length by treatment and dose",col=c("orange", "yellow"), cex=20)
boxplot(len~interaction(supp,dose),data=tg,ylab="Tooth Length",
names=c("OJ 0.5mg","AA 0.5mg","OJ 1mg","AA 1mg","AA 2mg","AA 2mg"),
main="Tooth length by treatment and dose",col=c("orange", "yellow"), cex.axis=.5)
boxplot(len~interaction(supp,dose),data=tg,ylab="Tooth Length",
names=c("OJ 0.5mg","AA 0.5mg","OJ 1mg","AA 1mg","AA 2mg","AA 2mg"),
main="Tooth length by treatment and dose",col=c("orange", "yellow"), cex.axis=.75)
boxplot(len~interaction(supp,dose),data=tg,ylab="Tooth Length",
names=c("OJ 0.5mg","AA 0.5mg","OJ 1mg","AA 1mg","AA 2mg","AA 2mg"),
main="Tooth length by treatment and dose",col=c("orange", "yellow"), cex.axis=.6)
boxplot(len~interaction(supp,dose),data=tg,ylab="Tooth Length",
names=c("OJ 0.5mg","AA 0.5mg","OJ 1mg","AA 1mg","AA 2mg","AA 2mg"),
main="Tooth length by treatment and dose",col=c("orange", "yellow"), cex.axis=.6, cex.main=.75, cex.lab=.75)
boxplot(len~interaction(supp,dose),data=tg,ylab="Tooth Length",
names=c("OJ 0.5mg","AA 0.5mg","OJ 1mg","AA 1mg","AA 2mg","AA 2mg"),
main="Tooth length by treatment and dose",col=c("orange", "yellow"), cex.axis=.6, cex.main=.75, cex.lab=.75)
?t.test
x=ToothGrowth[ToothGrowth$supp=="OJ"&ToothGrowth$dose==0.5,"len"], y=ToothGrowth[ToothGrowth$supp=="VC"&ToothGrowth$dose==0.5,"len"]
x=ToothGrowth[ToothGrowth$supp=="OJ"&ToothGrowth$dose==0.5,"len"]
y=ToothGrowth[ToothGrowth$supp=="VC"&ToothGrowth$dose==0.5,"len"]
t.test(x=ToothGrowth[ToothGrowth$supp=="OJ"&ToothGrowth$dose==0.5,"len"], y=ToothGrowth[ToothGrowth$supp=="VC"&ToothGrowth$dose==0.5,"len"])
t.test(x-y)
t.test(ToothGrowth[ToothGrowth$supp=="OJ"&ToothGrowth$dose==0.5,"len"], ToothGrowth[ToothGrowth$supp=="VC"&ToothGrowth$dose==0.5,"len"])
ToothGrowth[ToothGrowth$supp=="OJ"&ToothGrowth$dose==0.5,"len"]
var(ToothGrowth[ToothGrowth$supp=="OJ"&ToothGrowth$dose==0.5,"len"])
var(ToothGrowth[ToothGrowth$supp=="VC"&ToothGrowth$dose==0.5,"len"]))
var(ToothGrowth[ToothGrowth$supp=="VC"&ToothGrowth$dose==0.5,"len"])
t.test(tg[tg$supp=="OJ" & tg$dose==0.5, "len"], tg[tg$supp=="VC" & tg$dose==0.5, "len"])
t.test(tg[tg$supp=="OJ" & tg$dose==1, "len"], tg[tg$supp=="VC" & tg$dose==1, "len"])
t.test(tg[tg$supp=="OJ" & tg$dose==2, "len"], tg[tg$supp=="VC" & tg$dose==2, "len"])
22.7-16.77
t.test(tg[tg$dose==0.5, "len"], tg[tg$dose==1, "len"])
t.test(tg[tg$dose==0.5, "len"], tg[tg$dose==1, "len"])
x <-t.test(tg[tg$dose==0.5, "len"], tg[tg$dose==1, "len"])
t.test(tg[tg$dose==0.5, "len"], tg[tg$dose==1, "len"])$conf.int
t.test(tg[tg$dose==0.5, "len"], tg[tg$dose==1, "len"])$conf.int
t.test(tg[tg$dose==0.5, "len"], tg[tg$dose==1, "len"])$p.value
qqnorm(tg[tg$dose==0.5, "len"])
t.test(tg[tg$dose==0.5, "len"], tg[tg$dose==1, "len"])$conf
t.test(tg[tg$dose==0.5, "len"], tg[tg$dose==2, "len"])$conf.int
t.test(tg[tg$dose==0.5, "len"], tg[tg$dose==1, "len"])$conf
t.test(tg[tg$dose==0.5, "len"], tg[tg$dose==1, "len"])$p.value
t.test(tg[tg$dose==0.5, "len"], tg[tg$dose==2, "len"])$conf
t.test(tg[tg$dose==0.5, "len"], tg[tg$dose==2, "len"])$p.value
t.test(tg[tg$dose==1, "len"], tg[tg$dose==2, "len"])$conf
clear
clear()
rm
t.test(tg[tg$dose==0.5, "len"], tg[tg$dose==1, "len"])$conf
t.test(tg[tg$dose==0.5, "len"], tg[tg$dose==1, "len"])$p.value
t.test(tg[tg$dose==0.5, "len"], tg[tg$dose==2, "len"])$conf
t.test(tg[tg$dose==0.5, "len"], tg[tg$dose==2, "len"])$p.value
t.test(tg[tg$dose==1, "len"], tg[tg$dose==2, "len"])$conf
t.test(tg[tg$dose==1, "len"], tg[tg$dose==2, "len"])$p.value
t.test(tg[tg$supp=="OJ", "len"], tg[tg$supp=="VC", "len"])$conf
t.test(tg[tg$supp=="OJ", "len"], tg[tg$supp=="VC", "len"])$p.value
t.test(tg[tg$supp=="OJ" & tg$dose==0.5, "len"], tg[tg$supp=="VC" & tg$dose==0.5, "len"])$conf
t.test(tg[tg$supp=="OJ" & tg$dose==0.5, "len"], tg[tg$supp=="VC" & tg$dose==0.5, "len"])$p.value
t.test(tg[tg$supp=="OJ" & tg$dose==1, "len"], tg[tg$supp=="VC" & tg$dose==1, "len"])$conf
t.test(tg[tg$supp=="OJ" & tg$dose==1, "len"], tg[tg$supp=="VC" & tg$dose==1, "len"])$p.value
t.test(tg[tg$supp=="OJ" & tg$dose==2, "len"], tg[tg$supp=="VC" & tg$dose==2, "len"])$conf
t.test(tg[tg$supp=="OJ" & tg$dose==2, "len"], tg[tg$supp=="VC" & tg$dose==2, "len"])$p.value
rbind(
t.test(tg[tg$dose==0.5, "len"], tg[tg$dose==1, "len"])$conf
t.test(tg[tg$dose==0.5, "len"], tg[tg$dose==1, "len"])$p.value
t.test(tg[tg$dose==0.5, "len"], tg[tg$dose==2, "len"])$conf
t.test(tg[tg$dose==0.5, "len"], tg[tg$dose==2, "len"])$p.value
t.test(tg[tg$dose==1, "len"], tg[tg$dose==2, "len"])$conf
t.test(tg[tg$dose==1, "len"], tg[tg$dose==2, "len"])$p.value
)
rbind(
t.test(tg[tg$dose==0.5, "len"], tg[tg$dose==1, "len"])$conf,
t.test(tg[tg$dose==0.5, "len"], tg[tg$dose==1, "len"])$p.value,
t.test(tg[tg$dose==0.5, "len"], tg[tg$dose==2, "len"])$conf,
t.test(tg[tg$dose==0.5, "len"], tg[tg$dose==2, "len"])$p.value,
t.test(tg[tg$dose==1, "len"], tg[tg$dose==2, "len"])$conf,
t.test(tg[tg$dose==1, "len"], tg[tg$dose==2, "len"])$p.value,
)
rbind(
t.test(tg[tg$dose==0.5, "len"], tg[tg$dose==1, "len"])$conf, t.test(tg[tg$dose==0.5, "len"], tg[tg$dose==1, "len"])$p.value
)
cbind(
t.test(tg[tg$dose==0.5, "len"], tg[tg$dose==1, "len"])$conf, t.test(tg[tg$dose==0.5, "len"], tg[tg$dose==1, "len"])$p.value
)
rbind(t.test(tg[tg$dose==0.5, "len"], tg[tg$dose==1, "len"])$conf,
t.test(tg[tg$dose==0.5, "len"], tg[tg$dose==2, "len"])$conf,
t.test(tg[tg$dose==1, "len"], tg[tg$dose==2, "len"])$conf)
rbind(t.test(tg[tg$dose==0.5, "len"], tg[tg$dose==1, "len"])$p.value,
t.test(tg[tg$dose==0.5, "len"], tg[tg$dose==2, "len"])$p.value,
t.test(tg[tg$dose==1, "len"], tg[tg$dose==2, "len"])$p.value,)
rbind(t.test(tg[tg$dose==0.5, "len"], tg[tg$dose==1, "len"])$p.value,
t.test(tg[tg$dose==0.5, "len"], tg[tg$dose==2, "len"])$p.value,
t.test(tg[tg$dose==1, "len"], tg[tg$dose==2, "len"])$p.value)
